import NFe_13477 from './data/13477.json';
import { downloadXLSXSpreadsheet } from './utils';
function downloadDanfeXLSXFromNfes(nfes, options) {
    const rows = nfes
        .map((nfe) => {
        const { ide, emit, det } = nfe.nfeProc.NFe.infNFe;
        return det.map(({ prod, imposto }) => {
            const { IPI, ICMS, COFINS, PIS } = imposto;
            // TODO: testar se o CST pode vir de vários lugares mesmo
            const cst = IPI?.IPINT?.CST ||
                ICMS?.ICMS40?.CST ||
                COFINS?.COFINSNT?.CST ||
                PIS?.PISNT?.CST;
            return {
                'Data de Emissão': ide.dhEmi,
                'Nome do Emitente': emit.xNome,
                'Número ': ide.nNF,
                'Descrição ': prod.xProd,
                'CST ': cst || 'NÃO ENCONTRADO',
                'Unidade ': prod.uTrib,
                'Quantidade ': prod.qTrib,
                'Valor Unitário': prod.vUnTrib,
                'Base de Cálculo ICMS': imposto.ICMS?.ICMS00?.vBC || 'NÃO ENCONTRADO',
                'Aliquota ICMS': imposto.ICMS?.ICMS00?.pICMS || 'NÃO ENCONTRADO',
            };
        });
    })
        .flat();
    downloadXLSXSpreadsheet(rows, options);
}
function downloadExampleDanfeXLSX() {
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    downloadDanfeXLSXFromNfes([NFe_13477], {
        filename: '[EXEMPLO] Danfe',
    });
}
export { downloadDanfeXLSXFromNfes, downloadExampleDanfeXLSX };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGFuZmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZGFuZmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxTQUFTLE1BQU0sbUJBQW1CLENBQUM7QUFFMUMsT0FBTyxFQUFFLHVCQUF1QixFQUFlLE1BQU0sU0FBUyxDQUFDO0FBZS9ELFNBQVMseUJBQXlCLENBQUMsSUFBYyxFQUFFLE9BQW9CO0lBQ3JFLE1BQU0sSUFBSSxHQUFtQixJQUFJO1NBQzlCLEdBQUcsQ0FBQyxDQUFDLEdBQUcsRUFBRSxFQUFFO1FBQ1gsTUFBTSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDO1FBQ2xELE9BQU8sR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxFQUFFLEVBQUU7WUFDbkMsTUFBTSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxHQUFHLE9BQU8sQ0FBQztZQUUzQyx5REFBeUQ7WUFDekQsTUFBTSxHQUFHLEdBQ1AsR0FBRyxFQUFFLEtBQUssRUFBRSxHQUFHO2dCQUNmLElBQUksRUFBRSxNQUFNLEVBQUUsR0FBRztnQkFDakIsTUFBTSxFQUFFLFFBQVEsRUFBRSxHQUFHO2dCQUNyQixHQUFHLEVBQUUsS0FBSyxFQUFFLEdBQUcsQ0FBQztZQUVsQixPQUFPO2dCQUNMLGlCQUFpQixFQUFFLEdBQUcsQ0FBQyxLQUFLO2dCQUM1QixrQkFBa0IsRUFBRSxJQUFJLENBQUMsS0FBSztnQkFDOUIsU0FBUyxFQUFFLEdBQUcsQ0FBQyxHQUFHO2dCQUNsQixZQUFZLEVBQUUsSUFBSSxDQUFDLEtBQUs7Z0JBQ3hCLE1BQU0sRUFBRSxHQUFHLElBQUksZ0JBQWdCO2dCQUMvQixVQUFVLEVBQUUsSUFBSSxDQUFDLEtBQUs7Z0JBQ3RCLGFBQWEsRUFBRSxJQUFJLENBQUMsS0FBSztnQkFDekIsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDLE9BQU87Z0JBQzlCLHNCQUFzQixFQUFFLE9BQU8sQ0FBQyxJQUFJLEVBQUUsTUFBTSxFQUFFLEdBQUcsSUFBSSxnQkFBZ0I7Z0JBQ3JFLGVBQWUsRUFBRSxPQUFPLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxLQUFLLElBQUksZ0JBQWdCO2FBQ2pFLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQztTQUNELElBQUksRUFBRSxDQUFDO0lBRVYsdUJBQXVCLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ3pDLENBQUM7QUFFRCxTQUFTLHdCQUF3QjtJQUMvQiw4REFBOEQ7SUFDOUQseUJBQXlCLENBQUMsQ0FBQyxTQUFnQixDQUFDLEVBQUU7UUFDNUMsUUFBUSxFQUFFLGlCQUFpQjtLQUM1QixDQUFDLENBQUM7QUFDTCxDQUFDO0FBRUQsT0FBTyxFQUFFLHlCQUF5QixFQUFFLHdCQUF3QixFQUFFLENBQUMifQ==